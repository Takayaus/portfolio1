<div class="container">
    <div class="tra-wrapper">
        <div class="tra-profile">
            <div class="tra-top">
                <div class="tra-left">
                    <%= image_tag(@trainer.image.url) %>
                </div>
                <% if current_user.already_liked?(@trainer) %>
                  <%= link_to trainer_like_path(@trainer), method: :delete, remote: :true do %>
                  <i class="fa fa-heart" aria-hidden="true" style="color: red;">
                  <%= @trainer.likes.count %> 
                  </i>
                  <% end %>
                <% else %>
                  <%= link_to trainer_likes_path(@trainer), method: :post, remote: :true do %>
                     <i class="fa fa-heart" aria-hidden="true" style="color: #C0C0C0;">
                  <%= @trainer.likes.count %> 
                  </i>
                  <% end %>
                <% end %>
                    <p id="star-ave">評価</p> 
    <script>
    $('#star-ave').raty({
    size: 36,
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    half: true,
    readOnly: true,
    score: <%= @trainer.comments.average(:rate).to_f.round(1) %>,
      });
    </script>
                <div class="tra-right">
                    <h3><%= @trainer.name %></h3>
                    <p>年齢：<%= @trainer.age %></p>
                    <p><%= @trainer.number %></p>
                </div> 
            </div>
            <div class="tra-middle">
                <h3>Profile</h3>
                <h5><%= @trainer.title %></h5>
                <div class="tra-content">
                    <h4>自己紹介・活動内容</h4>
                    <p><%= @trainer.content %></p>
                    <h4>料金システム</h4>
                    <p><%= @trainer.price %></p>
                </div>
            </div>
        </div>
    </div>
        <div class="comment-wrapper border-top mb-10">
  <p class="mt-5">コメント一覧</p>
  <% @comments.each do |c| %>
    <div>
      <%= c.user.name unless c.user.blank? %>
      <br />
      <%= c.content %>
                <% if user_signed_in? && c.user == current_user %>
        <p><%= link_to 'Delete', gym_comment_path(@trainer, c), method: :delete %></p>
      <% end %>
          <div id="star-rate-<%= c.id %>"></div>
                <script>
                $('#star-rate-<%= c.id %>').raty({
                  size: 36,
                  starOff:  '<%= asset_path('star-off.png') %>',
                  starOn : '<%= asset_path('star-on.png') %>',
                  starHalf: '<%= asset_path('star-half.png') %>',
                  half: true,
                  readOnly: true,
                  score: <%= c.rate %>,
                });
                </script>  

    </div>
    <br />
  <% end %>
  <% if user_signed_in? %>
    <%= form_with(model: [@trainer, @comment], local: true) do |f| %>
    <div class="form-group row">
      <%= f.label :title, 'タイトル' %>
      <div class="col-sm-10">
        <%= f.text_field :title, class: "form-control", rows: 5 %>
      </div>
    </div>

 <div class="form-group" id="star">
              <%= f.label :rate,'評価' %>
              <%= f.hidden_field :rate, id: :comment_star %>
            </div>

                          <!-- 評価javascript -->
                          <script>
                          $('#star').raty({
                            size     : 36,
                            starOff:  '<%= asset_path('star-off.png') %>',
                            starOn : '<%= asset_path('star-on.png') %>',
                            starHalf: '<%= asset_path('star-half.png') %>',
                            scoreName: 'comment[rate]',
                            half: true,
                          });
                          </script>
        <div class="form-group row">
          <%= f.label :content, '口コミ内容' %>
          <div class="col-sm-10">
         <%= f.text_area :content, class: "form-control", rows: 5 %>
         </div>
         </div>
           <div class="form-group row">
    <div class="col-sm-10">
      <%= button_tag type: "submit", class: "btn btn-success float-right mt-1" do %>
        <i class="far fa-comments"></i> コメントする
        </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
</div>